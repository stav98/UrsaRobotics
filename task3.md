---
layout: default
---
<div style="text-align: justify;">
 <h1>Σχεδιασμός ηλεκτρονικού κυκλώματος</h1>
 <p>Το θεωρητικό κύκλωμα που ακολουθεί αφορά τον ελεγκτή και αναθεωρήθηκε αρκετές φορές μέχρι να φτάσει στη τελική του μορφή. Φυσικά κατά την υλοποίηση προέκυψαν ιδέες που ενδεχομένως να ενσωματωθούν σε επόμενες εκδόσεις του κυκλώματος.</p>
 <center>
  <a href="{{ "/assets/images/smart_home_schematic.png" | relative_url }}" onclick="return hs.expand(this)" class="highslide" target="_self">
   <img src="{{ "/assets/images/smart_home_schematic_small.png" | relative_url }}" alt="Μεγένθυση" title="Μεγένθυση" style="float: center; margin: 5px; border: 1px solid #000000; width: 400px;">
  </a>
 </center>
 <p>Σύμφωνα με το σχηματικό βλέπουμε ότι η παροχή ισχύος 5V/1A γίνεται μέσα από την κλέμα J6 και το ενδεικτικό LED LD6 ανάβει. Το άρθρωμα U1 (Node-MCU) που είναι και ο “εγκέφαλος” της πλακέτας, τροφοδοτείται με τάση 5V στο pin Vin (30) και παράγει μέσω του ενσωματωμένου σταθεροποιητή τάση 3,3V για δική του εσωτερική χρήση αλλά και για τα υπόλοιπα κυκλώματα τα οποία λειτουργούν μ’ αυτή τη τάση. Η τάση των 3,3V εξάγεται από τα pins 1, 10 και 26. Τα pins Tx και Rx δεν πρέπει να χρησιμοποιηθούν γιατί χρειάζονται για το ανέβασμα του κώδικα καθώς και τα μηνύματα αποσφαλμάτωσης (debugging). Τα GPIO04 και GPIO05 χρησιμοποιούνται για την σύνδεση του <a href="https://el.wikipedia.org/wiki/I%C2%B2C" target="_blank">διαύλου I2C</a> με το BME280 και το Arduino Nano. Επειδή το Arduino λειτουργεί με επίπεδα 0-5V, τα transistors NPN Q9 και Q10 μαζί με τα τριγύρω εξαρτήματα, υλοποιούν έναν απλό αμφίδρομο level shifter από τα επίπεδα 0-5V στα επίπεδα 0-3,3V. Τα GPIO12 και GPIO14 συνδέονται με τα ψηφιακά θερμόμετρα DS18B20 μέσω του διαύλου <a href="https://en.wikipedia.org/wiki/1-Wire" target="_blank">1-Wire</a>. Εδώ να επισημάνουμε ότι αρκεί ένα pin για πολλές συσκευές 1-Wire αλλά θα πρέπει στην αρχή να έχουμε κρατήσει τον κωδικό ID του κάθε θερμομέτρου ώστε να τα ξεχωρίζουμε. Με τον δικό μας τρόπο σπαταλάμε ένα επιπλέον pin αλλά ξέρουμε που συνδέεται το κάθε θερμόμετρο. Επίσης αν το μήκος των καλωδίων είναι μικρό (<1m) δεν απαιτείται τάση τροφοδοσίας. Δηλαδή λειτουργεί με ένα ζεύγος καλωδίων. Με τρία σύρματα (δηλ. +3,3V – Δεδομένα 1-wire – γείωση) τα καλώδια μπορούν να ξεπεράσουν το μήκος των 30m.</p>
 <p>Το άρθρωμα U2 είναι ένα Arduino Nano. Όπως και πριν αναφέραμε, αυτό χρησιμοποιείται ως ένας ευέλικτος – προγραμματιζόμενος port expander. Η χρήση του κάθε pin (είσοδος, έξοδος, ψηφιακό ή αναλογικό), εξαρτάται από τα κυκλώματα interface τα οποία συνδέουν αυτό με την κάθε συσκευή. Δηλαδή μπορούν να φτιαχτούν διάφορες παραλλαγές του expander ανάλογα με τις συσκευές που θέλουμε να υποστηρίξουμε.</p>
 <p>Η συγκεκριμένη πλακέτα διαθέτει τους ακόλουθους τύπους εξόδων:</p>
 <ul>
  <li>Τρεις (3) <a href="https://en.wikipedia.org/wiki/Galvanic_isolation" target="_blank">γαλβανικά απομονωμένες</a> εξόδους ρελέ έντασης 10A. Δηλαδή σ’ αυτές μπορούμε να συνδέσουμε τρεις συσκευές ισχύος έως 2500W στα 220V. Τα transistors Q1, Q2,Q3 παρέχουν το απαιτούμενο ρεύμα οδήγησης του πηνίου για το οπλισμό των επαφών στα τρία ρελέ RL1, RL2, RL3. Τα Leds LD1, LD2, LD3 χρησιμοποιούνται ως monitor ώστε να γνωρίζουμε ποιο ρελέ έχει ενεργοποιηθεί.</li>
  <li>Δύο (2) εξόδους <a href="https://en.wikipedia.org/wiki/Open_collector" target="_blank">ανοιχτού συλλέκτη (open collector)</a> 50V 100mA. Εδώ μπορούμε να συνδέσουμε επιπλέον ρελέ ράγας ώστε να ελέγχουμε συσκευές ισχύος π.χ. 5Kw. Στη μακέτα λειτουργούν σε χαμηλή ισχύ δηλαδή χωρίς τα ρελέ όπου ανάβει ένα LED ή ενεργοποιείται το buzzer της σειρήνας. Τα Q5 και Q6 παρέχουν το ρεύμα των 100mA και οι συλλέκτες μπορούν να δεχτούν τάση έως 50V.</li>
  <li>Τρεις (3) εξόδους <a href="https://en.wikipedia.org/wiki/Pulse-width_modulation" target="_blank">PWM</a> (open collector) 50V 100mA. Εδώ μπορούμε να συνδέσουμε <a href="https://www.mouser.com/ds/2/149/MOC3081M-356014.pdf" target="_blank">optotriac</a> ώστε να επιτύχουμε γαλβανική απομόνωση και μετά <a href="https://en.wikipedia.org/wiki/TRIAC" target="_blank">triac</a> ισχύος ώστε να ελέγχουμε την ένταση του ρεύματος σε συσκευές μέχρι 3Kw. Στη μακέτα δεν υπάρχουν τα optotriac και λειτουργούν σε χαμηλή ένταση ρυθμίζοντας την φωτεινότητα των LEDs. Τα Q6, Q7 και Q8 παρέχουν το απαιτούμενο ρεύμα και απομονώνουν τα pins του Arduino από τα φορτία εξόδου.</li>
  <li>Δύο (2) εξόδους για <a href="https://en.wikipedia.org/wiki/Servomotor" target="_blank">Servo motors</a> χωρίς καμία απομόνωση. Σε πραγματικό σύστημα εδώ απαιτείται επιπλέον κύκλωμα για την περιστροφή των κινητήρων ισχύος εμπρός ή ανάποδα με έλεγχο θέσης και τερματικούς διακόπτες.</li>
 </ul>
 <p>Οι τύποι εισόδων είναι:</p>
 <ul>
  <li>Τρεις (3) <a href="https://en.wikipedia.org/wiki/Analog-to-digital_converter" target="_blank">αναλογικές είσοδοι</a> 0-5V (10bit). Στις A1 και A6 συνδέονται οι φωτοαντιστάσεις LDR. Οι αντιστάσεις R1 και R2 σε συνδυασμό με τα LDR συνθέτουν ένα διαιρέτη τάσης ώστε αν έχουμε μέγιστη φωτεινότητα η τάση στα pins Α1 και A6 να είναι 5V ενώ στο σκοτάδι να είναι 0V. Στην A7 συνδέεται το φωτοβολταϊκό πάνελ. Η αντίσταση R23 διαρρέεται από ρεύμα ανάλογο με την ένταση της ηλιοφάνειας και εμείς μετράμε την τάση στα άκρα αυτής της αντίστασης.</li>
  <li>Τέσσερις (4) ψηφιακές εισόδους για buttons ή διακόπτες. Οι επαφές κλείνουν κύκλωμα με την γη και δεν είναι γαλβανικά απομονωμένες. Οι δίοδοι D1-D4 προστατεύουν το Arduino από λάθος συνδέσεις και πιθανή παροχή υψηλών τάσεων στα pins. Αν θέλουμε περισσότερη προστασία, τότε πρέπει να απομονώσουμε γαλβανικά τις εισόδους κάνοντας χρήση <a href="https://en.wikipedia.org/wiki/Opto-isolator" target="_blank">optocouplers</a>.</li>
 </ul>
 <p><a href="https://github.com/stav98/UrsaRobotics_SmartHome/blob/master/hardware/smart_home_schematic.pdf" target="_blank">Το θεωρητικό κύκλωμα σε μορφή pdf.</a></p>
 <a href="./index.html">Αρχική</a>
</div>
